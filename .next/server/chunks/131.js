"use strict";exports.id=131,exports.ids=[131],exports.modules={2719:(e,s,a)=>{a.d(s,{E:()=>ei});var t=a(326),r=a(9236),i=a(4723),o=a(2576),n=a(5047),l=a(7577),d=a(2237),c=a(9914),m=a(6228),x=a(2943),u=a(3011),p=a(4690),f=a(1664),h=a(9469),N=a(1223),j=a(4794);let g=i.RV,b=l.createContext({}),y=({...e})=>t.jsx(b.Provider,{value:{name:e.name},children:t.jsx(i.Qr,{...e})}),v=()=>{let e=l.useContext(b),s=l.useContext(w),{getFieldState:a,formState:t}=(0,i.Gc)(),r=a(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=s;return{id:o,name:e.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...r}},w=l.createContext({}),k=l.forwardRef(({className:e,...s},a)=>{let r=l.useId();return t.jsx(w.Provider,{value:{id:r},children:t.jsx("div",{ref:a,className:(0,N.cn)("space-y-2",e),...s})})});k.displayName="FormItem";let D=l.forwardRef(({className:e,...s},a)=>{let{error:r,formItemId:i}=v();return t.jsx(j._,{ref:a,className:(0,N.cn)(r&&"text-destructive",e),htmlFor:i,...s})});D.displayName="FormLabel";let C=l.forwardRef(({...e},s)=>{let{error:a,formItemId:r,formDescriptionId:i,formMessageId:o}=v();return t.jsx(h.g7,{ref:s,id:r,"aria-describedby":a?`${i} ${o}`:`${i}`,"aria-invalid":!!a,...e})});C.displayName="FormControl",l.forwardRef(({className:e,...s},a)=>{let{formDescriptionId:r}=v();return t.jsx("p",{ref:a,id:r,className:(0,N.cn)("text-sm text-muted-foreground",e),...s})}).displayName="FormDescription";let R=l.forwardRef(({className:e,children:s,...a},r)=>{let{error:i,formMessageId:o}=v(),n=i?String(i?.message??""):s;return n?t.jsx("p",{ref:r,id:o,className:(0,N.cn)("text-sm font-medium text-destructive",e),...a,children:n}):null});R.displayName="FormMessage";var S=a(1190),z=a(2015),O=a(9074),I=a(8393),M=a(6633),$=a(2933);let _=O.fC;O.ZA;let B=O.B4,Z=l.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(O.xz,{ref:r,className:(0,N.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,t.jsx(O.JO,{asChild:!0,children:t.jsx(I.Z,{className:"h-4 w-4 opacity-50"})})]}));Z.displayName=O.xz.displayName;let J=l.forwardRef(({className:e,...s},a)=>t.jsx(O.u_,{ref:a,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(M.Z,{className:"h-4 w-4"})}));J.displayName=O.u_.displayName;let A=l.forwardRef(({className:e,...s},a)=>t.jsx(O.$G,{ref:a,className:(0,N.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(I.Z,{className:"h-4 w-4"})}));A.displayName=O.$G.displayName;let T=l.forwardRef(({className:e,children:s,position:a="popper",...r},i)=>t.jsx(O.h_,{children:(0,t.jsxs)(O.VY,{ref:i,className:(0,N.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...r,children:[t.jsx(J,{}),t.jsx(O.l_,{className:(0,N.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(A,{})]})}));T.displayName=O.VY.displayName,l.forwardRef(({className:e,...s},a)=>t.jsx(O.__,{ref:a,className:(0,N.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=O.__.displayName;let F=l.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(O.ck,{ref:r,className:(0,N.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(O.wU,{children:t.jsx($.Z,{className:"h-4 w-4"})})}),t.jsx(O.eT,{children:s})]}));F.displayName=O.ck.displayName,l.forwardRef(({className:e,...s},a)=>t.jsx(O.Z0,{ref:a,className:(0,N.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=O.Z0.displayName;var P=a(1027),L=a(3194),H=a(2461);let V=l.forwardRef(({className:e,...s},a)=>t.jsx(H.fC,{className:(0,N.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:a,children:t.jsx(H.bU,{className:(0,N.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));V.displayName=H.fC.displayName;var E=a(9752),U=a(5296),Y=a(4097),W=a(9526),q=a(6764),G=a(7358),X=a(8091),K=a(5290),Q=a(7525);let ee=o.z.object({selected:o.z.boolean(),customName:o.z.string().max(30,"Custom service name must be 30 characters or less.").optional(),subService:o.z.string().optional(),notes:o.z.string().max(50,"Service notes must be 50 characters or less.").optional()}),es=o.z.object(q.Mk.reduce((e,s)=>(e[s]=ee,e),{})),ea=o.z.object({clockNumberMediaName:o.z.string().min(1,"Clock Number / Media Name is required."),orderNumber:o.z.string().optional(),client:o.z.string().optional(),agency:o.z.string().optional(),deliveryDate:o.z.date({required_error:"Delivery Date is required."}),poReference:o.z.string().optional(),destination:o.z.string().optional(),customDestination:o.z.string().max(50,"Custom destination must be 50 characters or less.").optional(),productionNotes:o.z.string().optional(),creator:o.z.string().regex(/^[A-Z0-9]{2,3}$|^$/,"Creator must be 2 or 3 uppercase alphanumeric initials.").optional(),checker:o.z.string().regex(/^[A-Z0-9]{2,3}$|^$/,"Checker must be 2 or 3 uppercase alphanumeric initials.").optional(),commercialDescription:o.z.string().optional(),status:o.z.nativeEnum(W.B).optional(),priority:o.z.boolean(),onHold:o.z.boolean(),inSAP:o.z.boolean(),stellarTask:o.z.boolean(),rate:o.z.number().optional(),services:es}).superRefine((e,s)=>{"Other..."!==e.destination||e.customDestination&&""!==e.customDestination.trim()||s.addIssue({code:o.z.ZodIssueCode.custom,message:"Please specify your custom destination.",path:["customDestination"]});let a=!1;for(let t of q.Mk){let r=e.services[t];r.selected&&(a=!0,"Other"!==t||r.customName&&""!==r.customName.trim()||s.addIssue({code:o.z.ZodIssueCode.custom,message:"Please specify custom service name.",path:[`services.${t}.customName`]}))}a||s.addIssue({code:o.z.ZodIssueCode.custom,message:"At least one service must be selected.",path:["services"]})}),et=()=>q.Mk.reduce((e,s)=>(e[s]={selected:!1,customName:"",subService:"",notes:""},e),{}),er=(e,s)=>{let a=s||(e&&"id"in e&&e.id?"edit":"create"),t={clockNumberMediaName:"",orderNumber:"",client:"",agency:"",deliveryDate:new Date,poReference:"",destination:"",customDestination:"",productionNotes:"",creator:"",checker:"",commercialDescription:"",status:W.B.Booked,priority:!1,onHold:!1,inSAP:!1,stellarTask:!1,rate:void 0,services:et()};if(!e)return t;let{services:r,...i}=e;if(Object.assign(t,i),e.deliveryDate){let s="string"==typeof e.deliveryDate?(0,d.Z)(e.deliveryDate):e.deliveryDate;(0,c.Z)(s)&&(t.deliveryDate=s)}return e.destination&&(q.eW.includes(e.destination)?t.destination=e.destination:(t.destination="Other...",t.customDestination=e.destination)),r&&Array.isArray(r)&&r.forEach(e=>{e&&"string"==typeof e.name&&(q.Mk.includes(e.name)?(t.services[e.name].selected=!0,t.services[e.name].subService=e.subService,t.services[e.name].notes=e.notes):(t.services.Other.selected=!0,t.services.Other.customName=e.name,t.services.Other.subService=e.subService,t.services.Other.notes=e.notes))}),"create"===a&&e&&(t.creator="",t.checker="",t.commercialDescription="",t.status=W.B.Booked,t.priority=!1,t.onHold=!1,t.inSAP=!1,t.stellarTask=!1,t.rate=void 0,"customDestination"in e&&e.customDestination&&(t.customDestination=e.customDestination)),t};function ei({mode:e,initialData:s,viewOnly:a=!1}){let o=(0,n.useRouter)(),{toast:c}=(0,Y.pm)(),[h,j]=(0,l.useState)(!1),[b,v]=(0,l.useState)(!1),[w,O]=(0,l.useState)(!1),[I,M]=(0,l.useState)("Loading date..."),[$,J]=(0,l.useState)(!1),{user:A}=(0,p.a)(),H=(0,l.useRef)(null),[ee,es]=(0,l.useState)(150),et=(0,l.useRef)(150),ei=(0,i.cI)({resolver:(0,r.F)(ea),defaultValues:er(s,e)}),eo=(0,l.useCallback)(async()=>{if(!H.current||!A)return;let e=H.current.offsetHeight;if(e!==et.current){es(e),et.current=e;try{await (0,x.Le)(A.userId,e)}catch(e){console.error("Failed to save scroll area height:",e)}}},[A]),en=(0,i.qo)({control:ei.control,name:"services"}),el=ei.watch("destination");ei.watch("deliveryDate");let ed=(0,l.useMemo)(()=>en?[...q.Mk].sort((e,s)=>{let a=en[e]?.selected??!1;return a===(en[s]?.selected??!1)?0:a?-1:1}):q.Mk,[en]),ec=async a=>{j(!0);try{let t=Object.entries(a.services).filter(([,e])=>e.selected).map(([e,s])=>({name:"Other"===e?"Other":e,subService:s.subService||"",notes:s.notes||"",customName:"Other"===e?s.customName:void 0})),r="Other..."===a.destination?a.customDestination||"":a.destination||"";if("create"===e){let e={clockNumberMediaName:a.clockNumberMediaName,deliveryDate:a.deliveryDate.toISOString(),destination:r,status:W.B.Booked,priority:a.priority,onHold:a.onHold,inSAP:a.inSAP,stellarTask:a.stellarTask,services:JSON.stringify(t)};a.orderNumber&&(e.orderNumber=a.orderNumber),a.client&&(e.client=a.client),a.agency&&(e.agency=a.agency),a.poReference&&(e.poReference=a.poReference),a.productionNotes&&(e.productionNotes=a.productionNotes),a.creator&&(e.creator=a.creator),a.checker&&(e.checker=a.checker),a.commercialDescription&&(e.commercialDescription=a.commercialDescription),void 0!==a.rate&&(e.rate=a.rate),await m.L.models.Job.create(e),c({title:"Job Created",description:`Job "${a.clockNumberMediaName}" has been successfully created.`}),o.push("/dashboard/open"),o.refresh()}else if(s&&"id"in s&&s.id){let e={clockNumberMediaName:a.clockNumberMediaName,deliveryDate:a.deliveryDate.toISOString(),destination:r,status:a.status||W.B.Booked,priority:a.priority,onHold:a.onHold,inSAP:a.inSAP,stellarTask:a.stellarTask,services:JSON.stringify(t)};a.orderNumber&&(e.orderNumber=a.orderNumber),a.client&&(e.client=a.client),a.agency&&(e.agency=a.agency),a.poReference&&(e.poReference=a.poReference),a.productionNotes&&(e.productionNotes=a.productionNotes),a.creator&&(e.creator=a.creator),a.checker&&(e.checker=a.checker),a.commercialDescription&&(e.commercialDescription=a.commercialDescription),void 0!==a.rate&&(e.rate=a.rate),await m.L.models.Job.update({id:s.id,...e}),c({title:"Job Updated",description:`Job "${e.clockNumberMediaName}" has been successfully updated.`}),o.push("/dashboard/open"),o.refresh()}}catch(e){console.error("Failed to submit job form:",e),c({title:"Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{j(!1)}},em=async()=>{if(s&&"id"in s&&s.id&&A){O(!0);try{await (0,u.W9)(s,A.userId),c({title:"Job Deleted",description:`Job "${s.clockNumberMediaName}" has been successfully deleted.`}),v(!1),o.push("/dashboard/open"),o.refresh()}catch(e){console.error("Failed to delete job:",e),c({title:"Error",description:"An unexpected error occurred while deleting the job.",variant:"destructive"})}finally{O(!1)}}},ex=(0,l.useMemo)(()=>a?`View Job: ${s?.clockNumberMediaName||""}`:"create"===e?s?"Duplicate Job":"Create New Job":`Edit Job: ${s?.clockNumberMediaName||""}`,[e,s,a]);return(0,t.jsxs)(E.Zb,{children:[t.jsx(E.Ol,{className:"pb-0",children:t.jsx(E.ll,{className:"font-headline text-lg",children:ex})}),t.jsx(E.aY,{children:t.jsx(g,{...ei,children:(0,t.jsxs)("form",{onSubmit:ei.handleSubmit(ec),className:"space-y-2",children:[(0,t.jsxs)("fieldset",{disabled:a,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-start",children:[t.jsx(y,{control:ei.control,name:"clockNumberMediaName",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1 md:col-span-2",children:[t.jsx(D,{className:"text-xs",children:"Clock Number / Media Name"}),t.jsx(C,{children:t.jsx(S.I,{...e,className:"h-8 text-xs"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"orderNumber",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Order Number"}),t.jsx(C,{children:t.jsx(S.I,{...e,className:"h-8 text-xs"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"deliveryDate",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Delivery Date"}),$&&(0,t.jsxs)("span",{className:"text-xs font-medium text-destructive",children:[" ","(In the Past)"]}),(0,t.jsxs)(P.J2,{children:[t.jsx(P.xo,{asChild:!0,children:t.jsx(C,{children:(0,t.jsxs)(f.z,{variant:"outline",disabled:a,className:(0,N.cn)("w-full pl-3 text-left font-normal h-8 text-xs",!e.value&&"text-muted-foreground"),children:[I,t.jsx(G.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),t.jsx(P.yk,{className:"w-auto p-0",align:"start",children:t.jsx(L.f,{mode:"single",selected:e.value,onSelect:e.onChange,initialFocus:!0})})]}),t.jsx(R,{})]})})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[t.jsx("h3",{className:"text-xs font-medium",children:"Service Details"}),t.jsx(Q.x,{ref:H,style:{height:`${ee}px`},onMouseUp:eo,className:(0,N.cn)("w-full rounded-md border p-2 overflow-auto",!a&&"resize-y"),children:t.jsx("div",{className:"space-y-2",children:ed.map(e=>{let s=en?.[e]?.selected,a="Other"===e;return t.jsx("div",{className:"p-2 rounded-md transition-colors bg-muted/20 hover:bg-muted/50",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-3 gap-y-1 items-start",children:[t.jsx(y,{control:ei.control,name:`services.${e}.selected`,render:({field:s})=>(0,t.jsxs)(k,{className:"flex flex-row items-center p-1 space-x-3 space-y-0 md:col-span-1",children:[t.jsx(C,{children:t.jsx(V,{id:`services.${e}.selected`,name:`services.${e}.selected`,checked:s.value,onCheckedChange:t=>{s.onChange(t),!t&&(ei.setValue(`services.${e}.subService`,""),ei.setValue(`services.${e}.notes`,""),a&&ei.setValue(`services.${e}.customName`,""))}})}),t.jsx(D,{htmlFor:`services.${e}.selected`,className:"font-normal text-xs",children:e})]})}),s&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-3 gap-y-2 md:col-span-3 items-start",children:[a&&t.jsx(y,{control:ei.control,name:`services.${e}.customName`,render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(C,{children:t.jsx(S.I,{...e,id:e.name,name:e.name,maxLength:30,className:"h-8 text-xs",placeholder:"Custom Service Name"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:`services.${e}.subService`,render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[(0,t.jsxs)(_,{onValueChange:e.onChange,value:e.value||"",name:e.name,children:[t.jsx(C,{children:t.jsx(Z,{id:e.name,className:"h-8 text-xs",children:t.jsx(B,{placeholder:"Sub-Service"})})}),t.jsx(T,{children:q.zj.map(e=>t.jsx(F,{value:e,children:e},e))})]}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:`services.${e}.notes`,render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1 md:col-span-2",children:[t.jsx(C,{children:t.jsx(S.I,{...e,id:e.name,name:e.name,maxLength:50,className:"h-8 text-xs",placeholder:"Service Notes"})}),t.jsx(R,{})]})})]})]})},e)})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[t.jsx(y,{control:ei.control,name:"client",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Client"}),t.jsx(C,{children:t.jsx(S.I,{...e,className:"h-8 text-xs"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"agency",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Agency"}),t.jsx(C,{children:t.jsx(S.I,{...e,className:"h-8 text-xs"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"poReference",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"PO Reference"}),t.jsx(C,{children:t.jsx(S.I,{...e,className:"h-8 text-xs"})}),t.jsx(R,{})]})}),(0,t.jsxs)("div",{children:[t.jsx(y,{control:ei.control,name:"destination",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Distributor"}),(0,t.jsxs)(_,{onValueChange:e.onChange,value:e.value||"",name:e.name,children:[t.jsx(C,{children:t.jsx(Z,{id:e.name,className:"h-8 text-xs",children:t.jsx(B,{})})}),t.jsx(T,{children:q.su.map(e=>t.jsx(F,{value:e,children:e},e))})]}),t.jsx(R,{})]})}),"Other..."===el&&t.jsx(y,{control:ei.control,name:"customDestination",render:({field:e})=>(0,t.jsxs)(k,{className:"mt-2 space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Custom Destination"}),t.jsx(C,{children:t.jsx(S.I,{...e,maxLength:50,className:"h-8 text-xs"})}),t.jsx(R,{})]})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-start",children:[t.jsx(y,{control:ei.control,name:"productionNotes",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1 md:col-span-2",children:[t.jsx(D,{className:"text-xs",children:"Production Notes"}),t.jsx(C,{children:t.jsx(z.g,{rows:1,...e,className:"text-xs min-h-[20px]"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"creator",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Creator"}),t.jsx(C,{children:t.jsx(S.I,{...e,maxLength:3,onChange:s=>e.onChange(s.target.value.toUpperCase()),className:"h-8 text-xs"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"checker",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1",children:[t.jsx(D,{className:"text-xs",children:"Checker"}),t.jsx(C,{children:t.jsx(S.I,{...e,maxLength:3,onChange:s=>e.onChange(s.target.value.toUpperCase()),className:"h-8 text-xs"})}),t.jsx(R,{})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[t.jsx(y,{control:ei.control,name:"priority",render:({field:e})=>(0,t.jsxs)(k,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[t.jsx(D,{className:"text-xs",children:"High Priority"}),t.jsx(C,{children:t.jsx(V,{checked:e.value,onCheckedChange:e.onChange,disabled:h||w})})]})}),t.jsx(y,{control:ei.control,name:"onHold",render:({field:e})=>(0,t.jsxs)(k,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[t.jsx(D,{className:"text-xs",children:"On Hold"}),t.jsx(C,{children:t.jsx(V,{checked:e.value,onCheckedChange:e.onChange,disabled:h||w})})]})}),t.jsx(y,{control:ei.control,name:"stellarTask",render:({field:e})=>(0,t.jsxs)(k,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[t.jsx(D,{className:"text-xs",children:"Stellar Task"}),t.jsx(C,{children:t.jsx(V,{checked:e.value,onCheckedChange:e.onChange,disabled:h||w})})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[t.jsx(y,{control:ei.control,name:"commercialDescription",render:({field:e})=>(0,t.jsxs)(k,{className:"space-y-1 md:col-span-3",children:[t.jsx(D,{className:"text-xs",children:"Commercial Description"}),t.jsx(C,{children:t.jsx(z.g,{rows:1,...e,className:"text-xs min-h-[16px]"})}),t.jsx(R,{})]})}),t.jsx(y,{control:ei.control,name:"inSAP",render:({field:e})=>(0,t.jsxs)(k,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[t.jsx(D,{className:"text-xs",children:"In SAP"}),t.jsx(C,{children:t.jsx(V,{checked:e.value,onCheckedChange:e.onChange,disabled:h||w})})]})})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[a?t.jsx("div",{}):(0,t.jsxs)("div",{className:"flex gap-2",children:["edit"===e&&t.jsx(f.z,{type:"button",onClick:()=>{if(!s)return;let e=new URLSearchParams;if(s.clockNumberMediaName&&e.append("clockNumberMediaName",s.clockNumberMediaName),s.orderNumber&&e.append("orderNumber",s.orderNumber),s.client&&e.append("client",s.client),s.agency&&e.append("agency",s.agency),s.poReference&&e.append("poReference",s.poReference),"services"in s&&s.services&&s.services.length>0&&e.append("services",JSON.stringify(s.services)),s.destination&&(q.eW.includes(s.destination)?e.append("destination",s.destination):(e.append("destination","Other..."),e.append("customDestination",s.destination))),s.deliveryDate){let a="string"==typeof s.deliveryDate?(0,d.Z)(s.deliveryDate):s.deliveryDate;a instanceof Date&&!isNaN(a.getTime())&&e.append("deliveryDate",a.toISOString())}s.productionNotes&&e.append("productionNotes",s.productionNotes),o.push(`/jobs/new?${e.toString()}`)},disabled:h||w,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:"Duplicate"}),"edit"===e&&s&&"id"in s&&s.id&&(0,t.jsxs)(U.aR,{open:b,onOpenChange:v,children:[t.jsx(U.vW,{asChild:!0,children:(0,t.jsxs)(f.z,{type:"button",variant:"destructive",disabled:h||w,children:[t.jsx(X.Z,{className:"mr-2 h-4 w-4"}),"Delete Job"]})}),(0,t.jsxs)(U._T,{children:[(0,t.jsxs)(U.fY,{children:[t.jsx(U.f$,{children:"Are you absolutely sure?"}),(0,t.jsxs)(U.yT,{children:['This action cannot be undone. This will permanently delete the job "',s.clockNumberMediaName,'" from the database.']})]}),(0,t.jsxs)(U.xo,{children:[t.jsx(U.le,{disabled:w,children:"Cancel"}),(0,t.jsxs)(U.OL,{onClick:em,disabled:w,className:"bg-destructive hover:bg-destructive/90",children:[w?t.jsx(K.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(f.z,{type:"button",variant:"outline",onClick:()=>o.back(),disabled:h||w,children:a?"Close":"Cancel"}),!a&&(0,t.jsxs)(f.z,{type:"submit",disabled:h||w,className:"bg-accent hover:bg-accent/90 text-accent-foreground",children:[h?t.jsx(K.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"create"===e?s?"Create Duplicate Job":"Create Job":"Save Changes"]})]})]})]})})})]})}},5296:(e,s,a)=>{a.d(s,{OL:()=>N,_T:()=>x,aR:()=>l,f$:()=>f,fY:()=>u,le:()=>j,vW:()=>d,xo:()=>p,yT:()=>h});var t=a(326),r=a(7577),i=a(5887),o=a(1223),n=a(1664);let l=i.fC,d=i.xz,c=i.h_,m=r.forwardRef(({className:e,...s},a)=>t.jsx(i.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-background/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:a}));m.displayName=i.aV.displayName;let x=r.forwardRef(({className:e,...s},a)=>(0,t.jsxs)(c,{children:[t.jsx(m,{}),t.jsx(i.VY,{ref:a,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));x.displayName=i.VY.displayName;let u=({className:e,...s})=>t.jsx("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});u.displayName="AlertDialogHeader";let p=({className:e,...s})=>t.jsx("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});p.displayName="AlertDialogFooter";let f=r.forwardRef(({className:e,...s},a)=>t.jsx(i.Dx,{ref:a,className:(0,o.cn)("text-lg font-semibold",e),...s}));f.displayName=i.Dx.displayName;let h=r.forwardRef(({className:e,...s},a)=>t.jsx(i.dk,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",e),...s}));h.displayName=i.dk.displayName;let N=r.forwardRef(({className:e,...s},a)=>t.jsx(i.aU,{ref:a,className:(0,o.cn)((0,n.d)(),e),...s}));N.displayName=i.aU.displayName;let j=r.forwardRef(({className:e,...s},a)=>t.jsx(i.$j,{ref:a,className:(0,o.cn)((0,n.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));j.displayName=i.$j.displayName},3194:(e,s,a)=>{a.d(s,{f:()=>d});var t=a(326);a(7577);var r=a(1890),i=a(9183),o=a(6035),n=a(1223),l=a(1664);function d({className:e,classNames:s,showOutsideDays:a=!0,...d}){return t.jsx(o._,{showOutsideDays:a,className:(0,n.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)((0,l.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)((0,l.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({className:e,...s})=>t.jsx(r.Z,{className:(0,n.cn)("h-4 w-4",e),...s}),IconRight:({className:e,...s})=>t.jsx(i.Z,{className:(0,n.cn)("h-4 w-4",e),...s})},...d})}d.displayName="Calendar"},9752:(e,s,a)=>{a.d(s,{Ol:()=>n,SZ:()=>d,Zb:()=>o,aY:()=>c,eW:()=>m,ll:()=>l});var t=a(326),r=a(7577),i=a(1223);let o=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));o.displayName="Card";let n=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let l=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));l.displayName="CardTitle";let d=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let c=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent";let m=r.forwardRef(({className:e,...s},a)=>t.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...s}));m.displayName="CardFooter"},4794:(e,s,a)=>{a.d(s,{_:()=>d});var t=a(326),r=a(7577),i=a(9152),o=a(9360),n=a(1223);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...s},a)=>t.jsx(i.f,{ref:a,className:(0,n.cn)(l(),e),...s}));d.displayName=i.f.displayName},1027:(e,s,a)=>{a.d(s,{J2:()=>n,xo:()=>l,yk:()=>d});var t=a(326),r=a(7577),i=a(2187),o=a(1223);let n=i.fC,l=i.xz,d=r.forwardRef(({className:e,align:s="center",sideOffset:a=4,...r},n)=>t.jsx(i.h_,{children:t.jsx(i.VY,{ref:n,align:s,sideOffset:a,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));d.displayName=i.VY.displayName},7525:(e,s,a)=>{a.d(s,{B:()=>l,x:()=>n});var t=a(326),r=a(7577),i=a(2836),o=a(1223);let n=r.forwardRef(({className:e,children:s,...a},r)=>(0,t.jsxs)(i.fC,{ref:r,className:(0,o.cn)("relative overflow-hidden",e),...a,children:[t.jsx(i.l_,{className:"h-full w-full rounded-[inherit]",children:s}),t.jsx(l,{}),t.jsx(i.Ns,{})]}));n.displayName=i.fC.displayName;let l=r.forwardRef(({className:e,orientation:s="vertical",...a},r)=>t.jsx(i.gb,{ref:r,orientation:s,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...a,children:t.jsx(i.q4,{className:"relative flex-1 rounded-full bg-border"})}));l.displayName=i.gb.displayName},2015:(e,s,a)=>{a.d(s,{g:()=>o});var t=a(326),r=a(7577),i=a(1223);let o=r.forwardRef(({className:e,...s},a)=>t.jsx("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));o.displayName="Textarea"},6764:(e,s,a)=>{a.d(s,{HZ:()=>b,Mk:()=>x,Uv:()=>g,VC:()=>j,bL:()=>h,eW:()=>p,fn:()=>N,su:()=>f,zj:()=>u});var t=a(9526),r=a(4471),i=a(5932),o=a(7582),n=a(9436),l=a(2179),d=a(891),c=a(6931),m=a(3734);let x=["Closed Captions","Audio Description","Open Captions","Translation","Transcription","Transcreation","BSL","Proofreading","Other"],u=["Original","Re-Edit","Cutdown","Re-encode","DTT","Premix","Mono AD","Other"],p=["XR Delivery","XR UK Delivery","Access","Peach"],f=[...p,"Other..."],h={[t.B.Booked]:r.Z,[t.B.Received]:i.Z,[t.B.Encoded]:o.Z,[t.B.Delivered]:n.Z,[t.B.Finished]:l.Z},N=d.Z,j=c.Z,g=m.Z;t.B.Booked,t.B.Received,t.B.Encoded,t.B.Delivered,t.B.Finished;let b=[t.B.Booked,t.B.Received,t.B.Encoded,t.B.Delivered,t.B.Finished]},3011:(e,s,a)=>{a.d(s,{W9:()=>r,po:()=>o,pt:()=>i});var t=a(6228);async function r(e,s,a){try{await t.L.models.DeletedJobs.create({originalJobId:e.id,clockNumberMediaName:e.clockNumberMediaName,orderNumber:e.orderNumber,services:JSON.stringify(e.services||[]),client:e.client,agency:e.agency,deliveryDate:e.deliveryDate,poReference:e.poReference,destination:e.destination,productionNotes:e.productionNotes,creator:e.creator,checker:e.checker,commercialDescription:e.commercialDescription,status:e.status,priority:e.priority,onHold:e.onHold,inSAP:e.inSAP,stellarTask:e.stellarTask,rate:e.rate||0,adjusted:e.adjusted||0,inputter:e.inputter||"",verifier:e.verifier||"",extcosts:e.extcosts||0,billingnotes:e.billingnotes||"",deletedBy:s,deletedAt:new Date().toISOString(),deletionReason:a||""}),await t.L.models.Job.delete({id:e.id})}catch(e){throw console.error("Failed to soft delete job:",e),e}}async function i(e,s){try{let{data:s}=await t.L.models.Job.create({clockNumberMediaName:e.clockNumberMediaName,orderNumber:e.orderNumber,services:e.services,client:e.client,agency:e.agency,deliveryDate:e.deliveryDate,poReference:e.poReference,destination:e.destination,productionNotes:e.productionNotes,creator:e.creator,checker:e.checker,commercialDescription:e.commercialDescription,status:e.status,priority:e.priority,onHold:e.onHold,inSAP:e.inSAP,stellarTask:e.stellarTask,rate:e.rate,adjusted:e.adjusted,inputter:e.inputter,verifier:e.verifier,extcosts:e.extcosts,billingnotes:e.billingnotes});if(!s)throw Error("Failed to create restored job");let{data:a}=await t.L.models.DeletedJobs.list(),r=a.find(s=>s.originalJobId===e.originalJobId);return r&&await t.L.models.DeletedJobs.delete({id:r.id}),s.id}catch(e){throw console.error("Failed to restore deleted job:",e),e}}async function o(e){try{await t.L.models.DeletedJobs.delete({id:e})}catch(e){throw console.error("Failed to permanently delete job:",e),e}}},9526:(e,s,a)=>{var t;a.d(s,{B:()=>t}),function(e){e.Booked="Booked",e.Received="Received",e.Encoded="Encoded",e.Delivered="Delivered",e.Finished="Finished"}(t||(t={})),Object.values(t)}};