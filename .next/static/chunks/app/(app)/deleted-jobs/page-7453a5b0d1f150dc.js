(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[471],{5677:function(e,t,r){Promise.resolve().then(r.bind(r,6044))},3639:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},8930:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6044:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(7437),a=r(2265),s=r(9376),i=r(1245),l=r(5656),o=r(4267),d=r(9820),c=r(2381),u=r(9174),f=r(5863),m=r(3639);let h=(0,r(9763).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var p=r(8930),x=r(3340),j=r(767),v=r(6159),b=r(8082);function y(){let[e,t]=(0,a.useState)([]),[r,y]=(0,a.useState)(!0),[g,N]=(0,a.useState)(null),[w,D]=(0,a.useState)(null),{user:k}=(0,i.a)(),J=(0,s.useRouter)(),{toast:R}=(0,x.pm)();(0,a.useEffect)(()=>{k&&(async()=>{try{let e=await (0,l.JU)();t(e)}catch(e){console.error("Failed to fetch deleted jobs:",e),R({title:"Error",description:"Failed to load deleted jobs.",variant:"destructive"})}finally{y(!1)}})()},[k,R]);let C=async e=>{if(k){N(e.originalJobId);try{let r=await (0,l.pt)(e,k.userId);t(t=>t.filter(t=>t.originalJobId!==e.originalJobId)),R({title:"Job Restored",description:'Job "'.concat(e.clockNumberMediaName,'" has been successfully restored.')}),J.push("/jobs/".concat(r))}catch(e){console.error("Failed to restore job:",e),R({title:"Error",description:"Failed to restore job.",variant:"destructive"})}finally{N(null)}}},P=async e=>{D(e.originalJobId);try{let{data:r}=await o.L.models.DeletedJobs.list(),n=r.find(t=>t.originalJobId===e.originalJobId);n&&(await (0,l.po)(n.id),t(t=>t.filter(t=>t.originalJobId!==e.originalJobId)),R({title:"Job Permanently Deleted",description:'Job "'.concat(e.clockNumberMediaName,'" has been permanently deleted.')}))}catch(e){console.error("Failed to permanently delete job:",e),R({title:"Error",description:"Failed to permanently delete job.",variant:"destructive"})}finally{D(null)}},A=e=>{try{return(0,v.Z)((0,b.Z)(e),"MMM dd, yyyy HH:mm")}catch(e){return"Invalid date"}};return r?(0,n.jsxs)("div",{className:"flex h-64 w-full items-center justify-center",children:[(0,n.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,n.jsx)("span",{className:"ml-2",children:"Loading deleted jobs..."})]}):(0,n.jsxs)("div",{className:"container mx-auto py-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Deleted Jobs"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage and restore deleted jobs. Jobs are kept here for 30 days before being permanently deleted."})]}),(0,n.jsx)(c.z,{variant:"outline",onClick:()=>J.push("/dashboard/open"),children:"Back to Dashboard"})]}),0===e.length?(0,n.jsx)(d.Zb,{children:(0,n.jsxs)(d.aY,{className:"flex flex-col items-center justify-center py-12",children:[(0,n.jsx)(m.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Deleted Jobs"}),(0,n.jsx)("p",{className:"text-muted-foreground text-center",children:"There are no deleted jobs to display. Deleted jobs will appear here for 30 days."})]})}):(0,n.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,n.jsxs)(d.Zb,{children:[(0,n.jsx)(d.Ol,{children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(d.ll,{className:"text-lg",children:e.clockNumberMediaName}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,n.jsx)(u.C,{variant:"outline",children:e.client}),(0,n.jsx)(u.C,{variant:"outline",children:e.agency}),(0,n.jsx)(u.C,{variant:"outline",children:e.status})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>C(e),disabled:g===e.originalJobId,children:[g===e.originalJobId?(0,n.jsx)(f.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(h,{className:"h-4 w-4"}),"Restore"]}),(0,n.jsxs)(j.aR,{children:[(0,n.jsx)(j.vW,{asChild:!0,children:(0,n.jsxs)(c.z,{size:"sm",variant:"destructive",disabled:w===e.originalJobId,children:[w===e.originalJobId?(0,n.jsx)(f.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(p.Z,{className:"h-4 w-4"}),"Delete Permanently"]})}),(0,n.jsxs)(j._T,{children:[(0,n.jsxs)(j.fY,{children:[(0,n.jsx)(j.f$,{children:"Permanently Delete Job"}),(0,n.jsxs)(j.yT,{children:['This action cannot be undone. This will permanently delete the job "',e.clockNumberMediaName,'" and all its data.']})]}),(0,n.jsxs)(j.xo,{children:[(0,n.jsx)(j.le,{children:"Cancel"}),(0,n.jsx)(j.OL,{onClick:()=>P(e),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Permanently"})]})]})]})]})]})}),(0,n.jsxs)(d.aY,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Order Number:"})," ",e.orderNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Delivery Date:"})," ",A(e.deliveryDate)]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Deleted:"})," ",A(e.deletedAt)]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Deleted By:"})," ",e.deletedBy]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"PO Reference:"})," ",e.poReference]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium",children:"Destination:"})," ",e.destination]})]}),e.deletionReason&&(0,n.jsxs)("div",{className:"mt-4 p-3 bg-muted rounded-md",children:[(0,n.jsx)("span",{className:"font-medium",children:"Deletion Reason:"})," ",e.deletionReason]})]})]},e.originalJobId))})]})}},9174:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var n=r(7437);r(2265);var a=r(535),s=r(3448);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...a})}},9685:function(e,t,r){"use strict";r.d(t,{aU:function(){return O},$j:function(){return E},VY:function(){return _},dk:function(){return F},aV:function(){return Z},h_:function(){return M},fC:function(){return A},Dx:function(){return S},xz:function(){return I}});var n=r(2265),a=r(7437);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(...e){return n.useCallback(function(...e){return t=>{let r=!1,n=e.map(e=>{let n=s(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():s(e[t],null)}}}}(...e),e)}var l=r(9105),o=r(8482),d="AlertDialog",[c,u]=function(e,t=[]){let r=[],s=()=>{let t=r.map(e=>n.createContext(e));return function(r){let a=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:a}}),[r,a])}};return s.scopeName=e,[function(t,s){let i=n.createContext(s),l=r.length;r=[...r,s];let o=t=>{let{scope:r,children:s,...o}=t,d=r?.[e]?.[l]||i,c=n.useMemo(()=>o,Object.values(o));return(0,a.jsx)(d.Provider,{value:c,children:s})};return o.displayName=t+"Provider",[o,function(r,a){let o=a?.[e]?.[l]||i,d=n.useContext(o);if(d)return d;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=r.reduce((t,{useScope:r,scopeName:n})=>{let a=r(e)[`__scope${n}`];return{...t,...a}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}(s,...t)]}(d,[l.p8]),f=(0,l.p8)(),m=e=>{let{__scopeAlertDialog:t,...r}=e,n=f(t);return(0,a.jsx)(l.fC,{...n,...r,modal:!0})};m.displayName=d;var h=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,s=f(r);return(0,a.jsx)(l.xz,{...s,...n,ref:t})});h.displayName="AlertDialogTrigger";var p=e=>{let{__scopeAlertDialog:t,...r}=e,n=f(t);return(0,a.jsx)(l.h_,{...n,...r})};p.displayName="AlertDialogPortal";var x=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,s=f(r);return(0,a.jsx)(l.aV,{...s,...n,ref:t})});x.displayName="AlertDialogOverlay";var j="AlertDialogContent",[v,b]=c(j),y=(0,o.sA)("AlertDialogContent"),g=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:s,...o}=e,d=f(r),c=n.useRef(null),u=i(t,c),m=n.useRef(null);return(0,a.jsx)(l.jm,{contentName:j,titleName:N,docsSlug:"alert-dialog",children:(0,a.jsx)(v,{scope:r,cancelRef:m,children:(0,a.jsxs)(l.VY,{role:"alertdialog",...d,...o,ref:u,onOpenAutoFocus:function(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),!1===r||!n.defaultPrevented)return t?.(n)}}(o.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(y,{children:s}),(0,a.jsx)(P,{contentRef:c})]})})})});g.displayName=j;var N="AlertDialogTitle",w=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,s=f(r);return(0,a.jsx)(l.Dx,{...s,...n,ref:t})});w.displayName=N;var D="AlertDialogDescription",k=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,s=f(r);return(0,a.jsx)(l.dk,{...s,...n,ref:t})});k.displayName=D;var J=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,s=f(r);return(0,a.jsx)(l.x8,{...s,...n,ref:t})});J.displayName="AlertDialogAction";var R="AlertDialogCancel",C=n.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=b(R,r),o=f(r),d=i(t,s);return(0,a.jsx)(l.x8,{...o,...n,ref:d})});C.displayName=R;var P=e=>{let{contentRef:t}=e,r="`".concat(j,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(j,"` by passing a `").concat(D,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(j,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return n.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},A=m,I=h,M=p,Z=x,_=g,O=J,E=C,S=w,F=k}},function(e){e.O(0,[868,969,748,449,105,233,849,971,117,744],function(){return e(e.s=5677)}),_N_E=e.O()}]);