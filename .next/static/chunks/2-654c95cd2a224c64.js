"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2],{3002:function(e,t,s){s.d(t,{E:function(){return ec}});var r=s(7437),a=s(9543),n=s(9501),i=s(1115),o=s(9376),c=s(2265),l=s(8082),d=s(1755),u=s(6159),m=s(6639),x=s(1878),p=s(4267),f=s(7504),h=s(5656),g=s(1245),j=s(2381),b=s(8482),v=s(3448),N=s(5060);let y=n.RV,w=c.createContext({}),k=e=>{let{...t}=e;return(0,r.jsx)(w.Provider,{value:{name:t.name},children:(0,r.jsx)(n.Qr,{...t})})},C=()=>{let e=c.useContext(w),t=c.useContext(D),{getFieldState:s,formState:r}=(0,n.Gc)(),a=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...a}},D=c.createContext({}),S=c.forwardRef((e,t)=>{let{className:s,...a}=e,n=c.useId();return(0,r.jsx)(D.Provider,{value:{id:n},children:(0,r.jsx)("div",{ref:t,className:(0,v.cn)("space-y-2",s),...a})})});S.displayName="FormItem";let R=c.forwardRef((e,t)=>{let{className:s,...a}=e,{error:n,formItemId:i}=C();return(0,r.jsx)(N._,{ref:t,className:(0,v.cn)(n&&"text-destructive",s),htmlFor:i,...a})});R.displayName="FormLabel";let z=c.forwardRef((e,t)=>{let{...s}=e,{error:a,formItemId:n,formDescriptionId:i,formMessageId:o}=C();return(0,r.jsx)(b.g7,{ref:t,id:n,"aria-describedby":a?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!a,...s})});z.displayName="FormControl",c.forwardRef((e,t)=>{let{className:s,...a}=e,{formDescriptionId:n}=C();return(0,r.jsx)("p",{ref:t,id:n,className:(0,v.cn)("text-sm text-muted-foreground",s),...a})}).displayName="FormDescription";let O=c.forwardRef((e,t)=>{var s;let{className:a,children:n,...i}=e,{error:o,formMessageId:c}=C(),l=o?String(null!==(s=null==o?void 0:o.message)&&void 0!==s?s:""):n;return l?(0,r.jsx)("p",{ref:t,id:c,className:(0,v.cn)("text-sm font-medium text-destructive",a),...i,children:l}):null});O.displayName="FormMessage";var I=s(279),Z=s(3675),_=s(9276),M=s(875),B=s(2135),F=s(401);let A=_.fC;_.ZA;let P=_.B4,J=c.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(_.xz,{ref:t,className:(0,v.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[a,(0,r.jsx)(_.JO,{asChild:!0,children:(0,r.jsx)(M.Z,{className:"h-4 w-4 opacity-50"})})]})});J.displayName=_.xz.displayName;let T=c.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(_.u_,{ref:t,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(B.Z,{className:"h-4 w-4"})})});T.displayName=_.u_.displayName;let L=c.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(_.$G,{ref:t,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(M.Z,{className:"h-4 w-4"})})});L.displayName=_.$G.displayName;let E=c.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...i}=e;return(0,r.jsx)(_.h_,{children:(0,r.jsxs)(_.VY,{ref:t,className:(0,v.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,r.jsx)(T,{}),(0,r.jsx)(_.l_,{className:(0,v.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(L,{})]})})});E.displayName=_.VY.displayName,c.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(_.__,{ref:t,className:(0,v.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=_.__.displayName;let H=c.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(_.ck,{ref:t,className:(0,v.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(_.wU,{children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(_.eT,{children:a})]})});H.displayName=_.ck.displayName,c.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(_.Z0,{ref:t,className:(0,v.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=_.Z0.displayName;var V=s(2749),U=s(6291),$=s(7181);let Y=c.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)($.fC,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:(0,r.jsx)($.bU,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});Y.displayName=$.fC.displayName;var q=s(9820),W=s(767),G=s(3340),X=s(6153),K=s(8705),Q=s(1047),ee=s(8930),et=s(5863),es=s(641);let er=i.z.object({selected:i.z.boolean(),customName:i.z.string().max(30,"Custom service name must be 30 characters or less.").optional(),subService:i.z.string().optional(),notes:i.z.string().max(50,"Service notes must be 50 characters or less.").optional()}),ea=i.z.object(K.Mk.reduce((e,t)=>(e[t]=er,e),{})),en=i.z.object({clockNumberMediaName:i.z.string().min(1,"Clock Number / Media Name is required."),orderNumber:i.z.string().optional(),client:i.z.string().optional(),agency:i.z.string().optional(),deliveryDate:i.z.date({required_error:"Delivery Date is required."}),poReference:i.z.string().optional(),destination:i.z.string().optional(),customDestination:i.z.string().max(50,"Custom destination must be 50 characters or less.").optional(),productionNotes:i.z.string().optional(),creator:i.z.string().regex(/^[A-Z0-9]{2,3}$|^$/,"Creator must be 2 or 3 uppercase alphanumeric initials.").optional(),checker:i.z.string().regex(/^[A-Z0-9]{2,3}$|^$/,"Checker must be 2 or 3 uppercase alphanumeric initials.").optional(),commercialDescription:i.z.string().optional(),status:i.z.nativeEnum(X.B).optional(),priority:i.z.boolean(),onHold:i.z.boolean(),inSAP:i.z.boolean(),stellarTask:i.z.boolean(),rate:i.z.number().optional(),services:ea}).superRefine((e,t)=>{"Other..."!==e.destination||e.customDestination&&""!==e.customDestination.trim()||t.addIssue({code:i.z.ZodIssueCode.custom,message:"Please specify your custom destination.",path:["customDestination"]});let s=!1;for(let r of K.Mk){let a=e.services[r];a.selected&&(s=!0,"Other"!==r||a.customName&&""!==a.customName.trim()||t.addIssue({code:i.z.ZodIssueCode.custom,message:"Please specify custom service name.",path:["services.".concat(r,".customName")]}))}s||t.addIssue({code:i.z.ZodIssueCode.custom,message:"At least one service must be selected.",path:["services"]})}),ei=()=>K.Mk.reduce((e,t)=>(e[t]={selected:!1,customName:"",subService:"",notes:""},e),{}),eo=(e,t)=>{let s=t||(e&&"id"in e&&e.id?"edit":"create"),r={clockNumberMediaName:"",orderNumber:"",client:"",agency:"",deliveryDate:new Date,poReference:"",destination:"",customDestination:"",productionNotes:"",creator:"",checker:"",commercialDescription:"",status:X.B.Booked,priority:!1,onHold:!1,inSAP:!1,stellarTask:!1,rate:void 0,services:ei()};if(!e)return r;let{services:a,...n}=e;if(Object.assign(r,n),e.deliveryDate){let t="string"==typeof e.deliveryDate?(0,l.Z)(e.deliveryDate):e.deliveryDate;(0,d.Z)(t)&&(r.deliveryDate=t)}return e.destination&&(K.eW.includes(e.destination)?r.destination=e.destination:(r.destination="Other...",r.customDestination=e.destination)),a&&Array.isArray(a)&&a.forEach(e=>{e&&"string"==typeof e.name&&(K.Mk.includes(e.name)?(r.services[e.name].selected=!0,r.services[e.name].subService=e.subService,r.services[e.name].notes=e.notes):(r.services.Other.selected=!0,r.services.Other.customName=e.name,r.services.Other.subService=e.subService,r.services.Other.notes=e.notes))}),"create"===s&&e&&(r.creator="",r.checker="",r.commercialDescription="",r.status=X.B.Booked,r.priority=!1,r.onHold=!1,r.inSAP=!1,r.stellarTask=!1,r.rate=void 0,"customDestination"in e&&e.customDestination&&(r.customDestination=e.customDestination)),r};function ec(e){let{mode:t,initialData:s,viewOnly:i=!1}=e,b=(0,o.useRouter)(),{toast:N}=(0,G.pm)(),[w,C]=(0,c.useState)(!1),[D,_]=(0,c.useState)(!1),[M,B]=(0,c.useState)(!1),[F,T]=(0,c.useState)("Loading date..."),[L,$]=(0,c.useState)(!1),{user:er}=(0,g.a)(),ea=(0,c.useRef)(null),[ei,ec]=(0,c.useState)(150),el=(0,c.useRef)(150),ed=(0,n.cI)({resolver:(0,a.F)(en),defaultValues:eo(s,t)});(0,c.useEffect)(()=>{er&&(async()=>{try{let e=await (0,f.SA)(er.userId);(null==e?void 0:e.initials)&&"create"===t&&!ed.getValues("creator")&&ed.setValue("creator",e.initials),(null==e?void 0:e.jobFormServiceHeight)&&(ec(e.jobFormServiceHeight),el.current=e.jobFormServiceHeight)}catch(e){console.log("No user preferences found")}})()},[t,er]);let eu=(0,c.useCallback)(async()=>{if(!ea.current||!er)return;let e=ea.current.offsetHeight;if(e!==el.current){ec(e),el.current=e;try{await (0,f.Le)(er.userId,e)}catch(e){console.error("Failed to save scroll area height:",e)}}},[er]),em=(0,n.qo)({control:ed.control,name:"services"}),ex=ed.watch("destination"),ep=ed.watch("deliveryDate"),ef=(0,c.useMemo)(()=>em?[...K.Mk].sort((e,t)=>{var s,r,a,n;let i=null!==(a=null===(s=em[e])||void 0===s?void 0:s.selected)&&void 0!==a&&a;return i===(null!==(n=null===(r=em[t])||void 0===r?void 0:r.selected)&&void 0!==n&&n)?0:i?-1:1}):K.Mk,[em]);(0,c.useEffect)(()=>{if(ep&&(0,d.Z)(ep)){T((0,u.Z)(ep,"dd MMM yyyy"));let e=(0,m.Z)(new Date),t=(0,m.Z)(ep);$((0,x.Z)(t,e))}else T("Pick a date"),$(!1)},[ep]),(0,c.useEffect)(()=>{ed.reset(eo(s,t))},[s,t]);let eh=async e=>{C(!0);try{let r=Object.entries(e.services).filter(e=>{let[,t]=e;return t.selected}).map(e=>{let[t,s]=e;return{name:"Other"===t?"Other":t,subService:s.subService||"",notes:s.notes||"",customName:"Other"===t?s.customName:void 0}}),a="Other..."===e.destination?e.customDestination||"":e.destination||"";if("create"===t){let t={clockNumberMediaName:e.clockNumberMediaName,deliveryDate:e.deliveryDate.toISOString(),destination:a,status:X.B.Booked,priority:e.priority,onHold:e.onHold,inSAP:e.inSAP,stellarTask:e.stellarTask,services:JSON.stringify(r)};e.orderNumber&&(t.orderNumber=e.orderNumber),e.client&&(t.client=e.client),e.agency&&(t.agency=e.agency),e.poReference&&(t.poReference=e.poReference),e.productionNotes&&(t.productionNotes=e.productionNotes),e.creator&&(t.creator=e.creator),e.checker&&(t.checker=e.checker),e.commercialDescription&&(t.commercialDescription=e.commercialDescription),void 0!==e.rate&&(t.rate=e.rate),await p.L.models.Job.create(t),N({title:"Job Created",description:'Job "'.concat(e.clockNumberMediaName,'" has been successfully created.')}),b.push("/dashboard/open"),b.refresh()}else if(s&&"id"in s&&s.id){let t={clockNumberMediaName:e.clockNumberMediaName,deliveryDate:e.deliveryDate.toISOString(),destination:a,status:e.status||X.B.Booked,priority:e.priority,onHold:e.onHold,inSAP:e.inSAP,stellarTask:e.stellarTask,services:JSON.stringify(r)};e.orderNumber&&(t.orderNumber=e.orderNumber),e.client&&(t.client=e.client),e.agency&&(t.agency=e.agency),e.poReference&&(t.poReference=e.poReference),e.productionNotes&&(t.productionNotes=e.productionNotes),e.creator&&(t.creator=e.creator),e.checker&&(t.checker=e.checker),e.commercialDescription&&(t.commercialDescription=e.commercialDescription),void 0!==e.rate&&(t.rate=e.rate),await p.L.models.Job.update({id:s.id,...t}),N({title:"Job Updated",description:'Job "'.concat(t.clockNumberMediaName,'" has been successfully updated.')}),b.push("/dashboard/open"),b.refresh()}}catch(e){console.error("Failed to submit job form:",e),N({title:"Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{C(!1)}},eg=async()=>{if(s&&"id"in s&&s.id&&er){B(!0);try{await (0,h.W9)(s,er.userId),N({title:"Job Deleted",description:'Job "'.concat(s.clockNumberMediaName,'" has been successfully deleted.')}),_(!1),b.push("/dashboard/open"),b.refresh()}catch(e){console.error("Failed to delete job:",e),N({title:"Error",description:"An unexpected error occurred while deleting the job.",variant:"destructive"})}finally{B(!1)}}},ej=(0,c.useMemo)(()=>i?"View Job: ".concat((null==s?void 0:s.clockNumberMediaName)||""):"create"===t?s?"Duplicate Job":"Create New Job":"Edit Job: ".concat((null==s?void 0:s.clockNumberMediaName)||""),[t,s,i]);return(0,r.jsxs)(q.Zb,{children:[(0,r.jsx)(q.Ol,{className:"pb-0",children:(0,r.jsx)(q.ll,{className:"font-headline text-lg",children:ej})}),(0,r.jsx)(q.aY,{children:(0,r.jsx)(y,{...ed,children:(0,r.jsxs)("form",{onSubmit:ed.handleSubmit(eh),className:"space-y-2",children:[(0,r.jsxs)("fieldset",{disabled:i,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-start",children:[(0,r.jsx)(k,{control:ed.control,name:"clockNumberMediaName",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1 md:col-span-2",children:[(0,r.jsx)(R,{className:"text-xs",children:"Clock Number / Media Name"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"orderNumber",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Order Number"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"deliveryDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Delivery Date"}),L&&(0,r.jsxs)("span",{className:"text-xs font-medium text-destructive",children:[" ","(In the Past)"]}),(0,r.jsxs)(V.J2,{children:[(0,r.jsx)(V.xo,{asChild:!0,children:(0,r.jsx)(z,{children:(0,r.jsxs)(j.z,{variant:"outline",disabled:i,className:(0,v.cn)("w-full pl-3 text-left font-normal h-8 text-xs",!t.value&&"text-muted-foreground"),children:[F,(0,r.jsx)(Q.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(V.yk,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(U.f,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]}),(0,r.jsx)(O,{})]})}})]}),(0,r.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,r.jsx)("h3",{className:"text-xs font-medium",children:"Service Details"}),(0,r.jsx)(es.x,{ref:ea,style:{height:"".concat(ei,"px")},onMouseUp:eu,className:(0,v.cn)("w-full rounded-md border p-2 overflow-auto",!i&&"resize-y"),children:(0,r.jsx)("div",{className:"space-y-2",children:ef.map(e=>{var t;let s=null==em?void 0:null===(t=em[e])||void 0===t?void 0:t.selected,a="Other"===e;return(0,r.jsx)("div",{className:"p-2 rounded-md transition-colors bg-muted/20 hover:bg-muted/50",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-x-3 gap-y-1 items-start",children:[(0,r.jsx)(k,{control:ed.control,name:"services.".concat(e,".selected"),render:t=>{let{field:s}=t;return(0,r.jsxs)(S,{className:"flex flex-row items-center p-1 space-x-3 space-y-0 md:col-span-1",children:[(0,r.jsx)(z,{children:(0,r.jsx)(Y,{id:"services.".concat(e,".selected"),name:"services.".concat(e,".selected"),checked:s.value,onCheckedChange:t=>{s.onChange(t),!t&&(ed.setValue("services.".concat(e,".subService"),""),ed.setValue("services.".concat(e,".notes"),""),a&&ed.setValue("services.".concat(e,".customName"),""))}})}),(0,r.jsx)(R,{htmlFor:"services.".concat(e,".selected"),className:"font-normal text-xs",children:e})]})}}),s&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-3 gap-y-2 md:col-span-3 items-start",children:[a&&(0,r.jsx)(k,{control:ed.control,name:"services.".concat(e,".customName"),render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,id:t.name,name:t.name,maxLength:30,className:"h-8 text-xs",placeholder:"Custom Service Name"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"services.".concat(e,".subService"),render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsxs)(A,{onValueChange:t.onChange,value:t.value||"",name:t.name,children:[(0,r.jsx)(z,{children:(0,r.jsx)(J,{id:t.name,className:"h-8 text-xs",children:(0,r.jsx)(P,{placeholder:"Sub-Service"})})}),(0,r.jsx)(E,{children:K.zj.map(e=>(0,r.jsx)(H,{value:e,children:e},e))})]}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"services.".concat(e,".notes"),render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1 md:col-span-2",children:[(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,id:t.name,name:t.name,maxLength:50,className:"h-8 text-xs",placeholder:"Service Notes"})}),(0,r.jsx)(O,{})]})}})]})]})},e)})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[(0,r.jsx)(k,{control:ed.control,name:"client",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Client"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"agency",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Agency"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"poReference",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"PO Reference"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k,{control:ed.control,name:"destination",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Distributor"}),(0,r.jsxs)(A,{onValueChange:t.onChange,value:t.value||"",name:t.name,children:[(0,r.jsx)(z,{children:(0,r.jsx)(J,{id:t.name,className:"h-8 text-xs",children:(0,r.jsx)(P,{})})}),(0,r.jsx)(E,{children:K.su.map(e=>(0,r.jsx)(H,{value:e,children:e},e))})]}),(0,r.jsx)(O,{})]})}}),"Other..."===ex&&(0,r.jsx)(k,{control:ed.control,name:"customDestination",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"mt-2 space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Custom Destination"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,maxLength:50,className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-start",children:[(0,r.jsx)(k,{control:ed.control,name:"productionNotes",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1 md:col-span-2",children:[(0,r.jsx)(R,{className:"text-xs",children:"Production Notes"}),(0,r.jsx)(z,{children:(0,r.jsx)(Z.g,{rows:1,...t,className:"text-xs min-h-[20px]"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"creator",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Creator"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,maxLength:3,onChange:e=>t.onChange(e.target.value.toUpperCase()),className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"checker",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Checker"}),(0,r.jsx)(z,{children:(0,r.jsx)(I.I,{...t,maxLength:3,onChange:e=>t.onChange(e.target.value.toUpperCase()),className:"h-8 text-xs"})}),(0,r.jsx)(O,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[(0,r.jsx)(k,{control:ed.control,name:"priority",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"High Priority"}),(0,r.jsx)(z,{children:(0,r.jsx)(Y,{checked:t.value,onCheckedChange:t.onChange,disabled:w||M})})]})}}),(0,r.jsx)(k,{control:ed.control,name:"onHold",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"On Hold"}),(0,r.jsx)(z,{children:(0,r.jsx)(Y,{checked:t.value,onCheckedChange:t.onChange,disabled:w||M})})]})}}),(0,r.jsx)(k,{control:ed.control,name:"stellarTask",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"Stellar Task"}),(0,r.jsx)(z,{children:(0,r.jsx)(Y,{checked:t.value,onCheckedChange:t.onChange,disabled:w||M})})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,r.jsx)(k,{control:ed.control,name:"commercialDescription",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"space-y-1 md:col-span-3",children:[(0,r.jsx)(R,{className:"text-xs",children:"Commercial Description"}),(0,r.jsx)(z,{children:(0,r.jsx)(Z.g,{rows:1,...t,className:"text-xs min-h-[16px]"})}),(0,r.jsx)(O,{})]})}}),(0,r.jsx)(k,{control:ed.control,name:"inSAP",render:e=>{let{field:t}=e;return(0,r.jsxs)(S,{className:"flex flex-row items-center justify-between rounded-lg border p-2 space-x-3 space-y-0 md:col-span-1",children:[(0,r.jsx)(R,{className:"text-xs",children:"In SAP"}),(0,r.jsx)(z,{children:(0,r.jsx)(Y,{checked:t.value,onCheckedChange:t.onChange,disabled:w||M})})]})}})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[i?(0,r.jsx)("div",{}):(0,r.jsxs)("div",{className:"flex gap-2",children:["edit"===t&&(0,r.jsx)(j.z,{type:"button",onClick:()=>{if(!s)return;let e=new URLSearchParams;if(s.clockNumberMediaName&&e.append("clockNumberMediaName",s.clockNumberMediaName),s.orderNumber&&e.append("orderNumber",s.orderNumber),s.client&&e.append("client",s.client),s.agency&&e.append("agency",s.agency),s.poReference&&e.append("poReference",s.poReference),"services"in s&&s.services&&s.services.length>0&&e.append("services",JSON.stringify(s.services)),s.destination&&(K.eW.includes(s.destination)?e.append("destination",s.destination):(e.append("destination","Other..."),e.append("customDestination",s.destination))),s.deliveryDate){let t="string"==typeof s.deliveryDate?(0,l.Z)(s.deliveryDate):s.deliveryDate;t instanceof Date&&!isNaN(t.getTime())&&e.append("deliveryDate",t.toISOString())}s.productionNotes&&e.append("productionNotes",s.productionNotes),b.push("/jobs/new?".concat(e.toString()))},disabled:w||M,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:"Duplicate"}),"edit"===t&&s&&"id"in s&&s.id&&(0,r.jsxs)(W.aR,{open:D,onOpenChange:_,children:[(0,r.jsx)(W.vW,{asChild:!0,children:(0,r.jsxs)(j.z,{type:"button",variant:"destructive",disabled:w||M,children:[(0,r.jsx)(ee.Z,{className:"mr-2 h-4 w-4"}),"Delete Job"]})}),(0,r.jsxs)(W._T,{children:[(0,r.jsxs)(W.fY,{children:[(0,r.jsx)(W.f$,{children:"Are you absolutely sure?"}),(0,r.jsxs)(W.yT,{children:['This action cannot be undone. This will permanently delete the job "',s.clockNumberMediaName,'" from the database.']})]}),(0,r.jsxs)(W.xo,{children:[(0,r.jsx)(W.le,{disabled:M,children:"Cancel"}),(0,r.jsxs)(W.OL,{onClick:eg,disabled:M,className:"bg-destructive hover:bg-destructive/90",children:[M?(0,r.jsx)(et.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(j.z,{type:"button",variant:"outline",onClick:()=>b.back(),disabled:w||M,children:i?"Close":"Cancel"}),!i&&(0,r.jsxs)(j.z,{type:"submit",disabled:w||M,className:"bg-accent hover:bg-accent/90 text-accent-foreground",children:[w?(0,r.jsx)(et.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"create"===t?s?"Create Duplicate Job":"Create Job":"Save Changes"]})]})]})]})})})]})}},6291:function(e,t,s){s.d(t,{f:function(){return l}});var r=s(7437);s(2265);var a=s(2451),n=s(407),i=s(633),o=s(3448),c=s(2381);function l(e){let{className:t,classNames:s,showOutsideDays:l=!0,...d}=e;return(0,r.jsx)(i._,{showOutsideDays:l,className:(0,o.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,c.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,o.cn)((0,c.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{className:t,...s}=e;return(0,r.jsx)(a.Z,{className:(0,o.cn)("h-4 w-4",t),...s})},IconRight:e=>{let{className:t,...s}=e;return(0,r.jsx)(n.Z,{className:(0,o.cn)("h-4 w-4",t),...s})}},...d})}l.displayName="Calendar"},279:function(e,t,s){s.d(t,{I:function(){return i}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},5060:function(e,t,s){s.d(t,{_:function(){return l}});var r=s(7437),a=s(2265),n=s(370),i=s(535),o=s(3448);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,o.cn)(c(),s),...a})});l.displayName=n.f.displayName},2749:function(e,t,s){s.d(t,{J2:function(){return o},xo:function(){return c},yk:function(){return l}});var r=s(7437),a=s(2265),n=s(82),i=s(3448);let o=n.fC,c=n.xz,l=a.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:o=4,...c}=e;return(0,r.jsx)(n.h_,{children:(0,r.jsx)(n.VY,{ref:t,align:a,sideOffset:o,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...c})})});l.displayName=n.VY.displayName},641:function(e,t,s){s.d(t,{B:function(){return c},x:function(){return o}});var r=s(7437),a=s(2265),n=s(5054),i=s(3448);let o=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(n.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",s),...o,children:[(0,r.jsx)(n.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(c,{}),(0,r.jsx)(n.Ns,{})]})});o.displayName=n.fC.displayName;let c=a.forwardRef((e,t)=>{let{className:s,orientation:a="vertical",...o}=e;return(0,r.jsx)(n.gb,{ref:t,orientation:a,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...o,children:(0,r.jsx)(n.q4,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=n.gb.displayName},3675:function(e,t,s){s.d(t,{g:function(){return i}});var r=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a})});i.displayName="Textarea"},8705:function(e,t,s){s.d(t,{HZ:function(){return y},LD:function(){return N},Mk:function(){return m},Uv:function(){return b},VC:function(){return j},bL:function(){return h},eW:function(){return p},fn:function(){return g},su:function(){return f},vj:function(){return v},zj:function(){return x}});var r=s(6153),a=s(4789),n=s(9345),i=s(2160),o=s(4743),c=s(6901),l=s(6399),d=s(512),u=s(6595);let m=["Closed Captions","Audio Description","Open Captions","Translation","Transcription","Transcreation","BSL","Proofreading","Other"],x=["Original","Re-Edit","Cutdown","Re-encode","DTT","Premix","Mono AD","Other"],p=["XR Delivery","XR UK Delivery","Access","Peach"],f=[...p,"Other..."],h={[r.B.Booked]:a.Z,[r.B.Received]:n.Z,[r.B.Encoded]:i.Z,[r.B.Delivered]:o.Z,[r.B.Finished]:c.Z},g=l.Z,j=d.Z,b=u.Z,v=[r.B.Booked,r.B.Received,r.B.Encoded,r.B.Delivered],N=[r.B.Finished],y=[r.B.Booked,r.B.Received,r.B.Encoded,r.B.Delivered,r.B.Finished]},6153:function(e,t,s){var r,a;s.d(t,{B:function(){return r}}),(a=r||(r={})).Booked="Booked",a.Received="Received",a.Encoded="Encoded",a.Delivered="Delivered",a.Finished="Finished",Object.values(r)},7504:function(e,t,s){s.d(t,{Le:function(){return c},SA:function(){return a},VR:function(){return o},l5:function(){return i}});var r=s(4267);async function a(e){try{let{data:t}=await r.L.models.UserPrefs.get({id:e});return t}catch(t){return console.log("No user preferences found for user:",e),null}}async function n(e,t){try{await r.L.models.UserPrefs.update({id:e,userId:e,...t})}catch(s){try{await r.L.models.UserPrefs.create({userId:e,...t})}catch(e){throw console.error("Failed to save user preferences:",e),e}}}async function i(e){await n(e,{lastActive:new Date().toISOString()})}async function o(e,t){await n(e,{initials:t})}async function c(e,t){await n(e,{jobFormServiceHeight:t})}}}]);